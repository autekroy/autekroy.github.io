<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="æ„Ÿæ©ç¯€ä¹‹æ—…">
    
    <!-- Icon -->
    <link rel="apple-touch-icon" href="https://img.icons8.com/color/480/grand-canyon.png">
    
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root {
            --theme-color: #D35400;
            --text-primary: #1c1c1e;
            --text-secondary: #8e8e93;
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
            --card-blur: rgba(255, 255, 255, 0.85);
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.04);
            --shadow-md: 0 8px 24px rgba(0,0,0,0.08);
            --bg-base: #F2F2F7;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        /* --- iOS é–å®šç•«é¢èˆ‡å½ˆæ€§ä¿®æ­£ --- */
        html {
            height: 100%; width: 100%; overflow: hidden; 
            background-color: var(--bg-base); overscroll-behavior: none;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-base);
            color: var(--text-primary);
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            overflow: hidden; overscroll-behavior: none;
        }

        /* --- Animations --- */
        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-item {
            opacity: 0;
            animation: fadeUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        .animate-item:nth-child(1) { animation-delay: 0.05s; }
        .animate-item:nth-child(2) { animation-delay: 0.1s; }
        .animate-item:nth-child(3) { animation-delay: 0.15s; }
        .animate-item:nth-child(4) { animation-delay: 0.2s; }
        .animate-item:nth-child(5) { animation-delay: 0.25s; }

        /* --- Backgrounds --- */
        .bg-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; background-color: var(--bg-base); }
        .bg-image {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover; background-position: center;
            transition: opacity 0.8s ease; opacity: 0; transform: scale(1.05);
        }
        .bg-image.active { opacity: 1; transform: scale(1); transition: opacity 0.8s ease, transform 10s linear; }
        .bg-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, rgba(255,255,255,0.85) 0%, rgba(255,255,255,0.5) 40%, rgba(242,242,247,0.92) 100%);
            z-index: 0; backdrop-filter: blur(2px);
        }

        /* --- Header --- */
        header {
            padding: calc(var(--safe-top) + 10px) 20px 10px;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(25px) saturate(180%); -webkit-backdrop-filter: blur(25px) saturate(180%);
            border-bottom: 0.5px solid rgba(0,0,0,0.05);
            position: absolute; top: 0; left: 0; width: 100%; z-index: 10;
            display: flex; justify-content: space-between; align-items: flex-start;
            transition: all 0.3s;
        }
        .header-left h1 { font-size: 28px; font-weight: 800; margin: 0; letter-spacing: -0.5px; color: #000; }
        .header-left .subtitle { 
            font-size: 13px; color: var(--theme-color); font-weight: 700; 
            margin-top: 4px; text-transform: uppercase; letter-spacing: 1px; 
            transition: color 0.3s ease;
        }

        .weather-widget {
            text-align: right; background: rgba(255,255,255,0.5); padding: 6px 12px; border-radius: 14px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05); display: flex; flex-direction: column; align-items: flex-end;
            border: 1px solid rgba(255,255,255,0.4);
            transition: opacity 0.3s ease, visibility 0.3s; cursor: pointer;
        }
        .weather-widget:active { transform: scale(0.95); background: rgba(255,255,255,0.8); }
        .weather-temp { font-size: 20px; font-weight: 700; color: #333; line-height: 1; }
        .weather-loc { font-size: 10px; color: #666; margin-top: 3px; font-weight: 600; text-transform: uppercase; }

        #countdown-banner {
            font-size: 11px; font-weight: 600; color: #fff; background: var(--theme-color);
            padding: 4px 10px; border-radius: 20px; margin-top: 5px; display: inline-block;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); opacity: 0; animation: fadeUp 0.5s 0.5s forwards;
            transition: background-color 0.3s ease;
        }

        /* --- Content --- */
        .content-area {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            overflow-y: auto; overflow-x: hidden;
            overscroll-behavior-y: none; -webkit-overflow-scrolling: touch;
            padding: calc(var(--safe-top) + 100px) 20px calc(var(--safe-bottom) + 80px);
            display: none; opacity: 0; transition: opacity 0.4s ease;
        }
        .content-area.active { display: block; opacity: 1; }

        /* Spacing Fix for First Card */
        #tab-hotels .card:first-child, #tab-flights .card:first-child { margin-top: 20px; }

        /* --- Weather Chart --- */
        .weather-detail-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 24px; padding: 20px 15px; margin-bottom: 20px;
            color: white; box-shadow: 0 10px 30px -10px rgba(0,0,0,0.3);
            position: relative; overflow: hidden;
            border: 1px solid rgba(255,255,255,0.2);
            cursor: pointer; transition: transform 0.2s;
        }
        .weather-detail-card:active { transform: scale(0.98); opacity: 0.9; }
        .wd-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 10px; padding: 0 5px; }
        .wd-title { font-weight: 700; font-size: 16px; display: flex; align-items: center; gap: 8px; }
        .wd-info { text-align: right; font-size: 12px; font-weight: 600; opacity: 0.9; }
        
        .wd-chart-container { width: 100%; height: 160px; position: relative; margin-top: 10px; }
        .wd-chart-svg { width: 100%; height: 100%; overflow: visible; display: block; }
        .chart-area { fill: rgba(255,255,255,0.15); }
        .chart-line { fill: none; stroke: white; stroke-width: 2.5; stroke-linecap: round; stroke-linejoin: round; filter: drop-shadow(0px 3px 3px rgba(0,0,0,0.1)); }
        .chart-dot { fill: white; stroke: rgba(0,0,0,0.1); stroke-width: 2px; }
        .chart-text { font-size: 11px; fill: white; font-weight: 700; text-anchor: middle; text-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .chart-label { font-size: 10px; fill: rgba(255,255,255,0.8); text-anchor: middle; font-weight: 500; }
        
        /* Chart Icons */
        #chart-icons-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
        .chart-icon-wrapper {
            position: absolute; transform: translateX(-50%); display: flex; justify-content: center; align-items: center;
        }
        .chart-icon-wrapper svg { width: 16px; height: 16px; color: rgba(255,255,255,0.9); filter: drop-shadow(0 2px 2px rgba(0,0,0,0.1)); }

        /* --- Scrollers --- */
        .day-scroller-container {
            position: sticky; top: 0; margin: -10px -20px 20px; padding: 15px 20px 10px;
            background: rgba(255,255,255,0.7); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            z-index: 5; border-bottom: 0.5px solid rgba(0,0,0,0.05);
            mask-image: linear-gradient(to bottom, black 85%, transparent 100%);
        }
        .day-scroller { display: flex; overflow-x: auto; gap: 10px; padding-bottom: 10px; scrollbar-width: none; }
        .day-scroller::-webkit-scrollbar { display: none; }
        
        /* Day Chip */
        .day-chip {
            flex: 0 0 auto; display: flex; flex-direction: column; align-items: center; justify-content: center;
            min-width: 68px; height: 64px; background: rgba(255,255,255,0.9); border-radius: 18px;
            font-size: 12px; color: var(--text-secondary); transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: var(--shadow-sm); 
            border: 1.5px solid color-mix(in srgb, var(--theme-color), transparent 70%);
        }
        .day-chip span.d-date { font-size: 20px; font-weight: 800; color: #1c1c1e; margin-bottom: 2px; }
        .day-chip span.d-week { font-weight: 500; font-size: 11px; opacity: 0.8; }
        .day-chip.active {
            background: var(--theme-color); color: white; 
            box-shadow: 0 8px 20px -5px var(--theme-color); 
            transform: translateY(-2px) scale(1.05); border-color: transparent;
        }
        .day-chip.active span.d-date { color: white; }
        
        /* Guide Chip */
        .guide-chip {
            flex: 0 0 auto; padding: 0 20px; height: 44px; 
            display: flex; align-items: center; justify-content: center;
            background: rgba(255,255,255,0.9); border-radius: 22px;
            font-size: 14px; font-weight: 700; color: var(--text-secondary);
            box-shadow: var(--shadow-sm); 
            border: 1.5px solid color-mix(in srgb, var(--theme-color), transparent 70%); 
            transition: all 0.3s;
        }
        .guide-chip.active { 
            background: var(--theme-color); color: white; 
            box-shadow: 0 6px 15px -4px var(--theme-color); transform: translateY(-1px); border-color: transparent;
        }

        /* --- Map Button --- */
        .map-btn-compact {
            display: flex; align-items: center; justify-content: center; gap: 8px;
            width: 100%; padding: 14px; margin-bottom: 15px;
            background: rgba(255,255,255,0.6); border-radius: 18px;
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.5);
            color: var(--theme-color); font-weight: 700; font-size: 15px;
            text-decoration: none; box-shadow: var(--shadow-sm);
            transition: transform 0.2s, background 0.2s;
        }
        .map-btn-compact:active { transform: scale(0.98); background: rgba(255,255,255,0.8); }

        /* --- Card & Items --- */
        .card {
            background: var(--card-blur); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px);
            border-radius: 24px; padding: 0; margin-bottom: 16px;
            box-shadow: var(--shadow-md); overflow: hidden;
            border: 1px solid rgba(255,255,255,0.4);
        }

        .place-item {
            padding: 22px 20px; border-bottom: 1px solid rgba(0,0,0,0.05); position: relative;
            transition: background 0.2s; cursor: pointer;
        }
        .place-item:active { background: rgba(0,0,0,0.03); }
        .place-item:last-child { border-bottom: none; }
        .place-item::after {
            content: 'â€º'; position: absolute; right: 20px; top: 50%; transform: translateY(-50%);
            font-size: 22px; color: #c7c7cc; font-weight: 600;
        }
        .place-item.no-arrow::after { display: none; }

        .place-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; padding-right: 20px; }
        .place-name { font-weight: 700; font-size: 18px; color: #1c1c1e; flex: 1; letter-spacing: -0.3px; }
        
        .place-tag { 
            font-size: 11px; background: var(--theme-color); padding: 5px 10px; border-radius: 10px; 
            color: white; font-weight: 700; white-space: nowrap; margin-left: 10px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        }
        .place-tag.secondary { background: #e5e5ea; color: #666; box-shadow: none; }
        .place-tag.highlight { background: #007AFF; color: white; box-shadow: 0 2px 6px rgba(0,122,255,0.3); }
        
        .place-desc { font-size: 15px; color: #666; line-height: 1.5; margin: 0; padding-right: 15px; }
        .hotel-date { font-size: 13px; color: #8e8e93; margin-top: 6px; display: block; font-weight: 600; }

        /* --- Packing List Styles --- */
        .packing-header { padding: 20px 20px 10px; }
        .progress-container { width: 100%; height: 8px; background: #e5e5ea; border-radius: 4px; overflow: hidden; margin-top: 10px; }
        .progress-bar { height: 100%; background: #34C759; width: 0%; transition: width 0.3s ease; }
        .progress-text { font-size: 13px; color: #8e8e93; font-weight: 600; margin-top: 8px; display: flex; justify-content: space-between; }
        .checkbox-item { display: flex; align-items: center; padding: 16px 20px; cursor: pointer; border-bottom: 1px solid rgba(0,0,0,0.05); transition: background 0.2s; }
        .checkbox-item:last-child { border-bottom: none; }
        .checkbox-item:active { background: rgba(0,0,0,0.02); }
        .custom-checkbox { width: 24px; height: 24px; border-radius: 6px; border: 2px solid #c7c7cc; margin-right: 15px; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .checkbox-item.checked .custom-checkbox { background: #34C759; border-color: #34C759; }
        .checkbox-item.checked .place-name { color: #aeaeb2; text-decoration: line-through; }
        .check-icon { color: white; opacity: 0; transform: scale(0.5); transition: all 0.2s; }
        .checkbox-item.checked .check-icon { opacity: 1; transform: scale(1); }

        /* --- Flight & Shuttle --- */
        .flight-time-row { display: flex; justify-content: space-between; align-items: center; margin: 18px 0; padding: 12px 0; border-top: 1px dashed rgba(0,0,0,0.1); border-bottom: 1px dashed rgba(0,0,0,0.1); }
        .flight-time-col { text-align: center; flex: 1; }
        .ft-label { font-size: 11px; color: #8e8e93; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 6px; font-weight: 600; }
        .ft-time { font-size: 22px; font-weight: 800; color: #1c1c1e; font-variant-numeric: tabular-nums; }
        .ft-icon { color: #d1d1d6; margin: 0 10px; }
        .lounge-info { background: #f2f2f7; padding: 14px; border-radius: 16px; margin-top: 12px; display: flex; gap: 12px; align-items: flex-start; }
        .lounge-text { font-size: 13px; color: #444; line-height: 1.5; font-weight: 500; }
        .lounge-badge { background: #002663; color: white; font-size: 10px; padding: 3px 8px; border-radius: 6px; font-weight: 800; display: inline-block; margin-bottom: 4px; }
        .shuttle-block { padding: 24px; background: transparent; }
        .shuttle-title { display: flex; align-items: center; gap: 8px; font-weight: 700; color: var(--theme-color); margin-bottom: 16px; font-size: 16px; }
        .shuttle-container { background: rgba(255,255,255,0.6); border-radius: 16px; padding: 16px; margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.5); }

        /* --- Modal --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.3); z-index: 200; opacity: 0; visibility: hidden; transition: all 0.3s; backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); }
        .modal-overlay.open { opacity: 1; visibility: visible; }
        .modal-sheet { position: absolute; bottom: 0; left: 0; width: 100%; background: #fff; border-radius: 30px 30px 0 0; padding: 30px 25px 60px; transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1); max-height: 85vh; overflow-y: auto; box-shadow: 0 -10px 40px rgba(0,0,0,0.1); }
        .modal-overlay.open .modal-sheet { transform: translateY(0); }
        .modal-handle { width: 40px; height: 5px; background: #e5e5ea; border-radius: 10px; margin: -10px auto 30px; }
        .modal-title { font-size: 26px; font-weight: 800; margin-bottom: 15px; color: #000; line-height: 1.2; }
        .modal-desc { font-size: 17px; color: #3a3a3c; line-height: 1.6; white-space: pre-wrap; font-weight: 400; }
        .modal-close-btn { position: absolute; top: 25px; right: 25px; background: #f2f2f7; border: none; width: 32px; height: 32px; border-radius: 50%; font-size: 20px; color: #3c3c43; display: flex; align-items: center; justify-content: center; cursor: pointer; }

        /* --- Tab Bar (Fixed & Compact - iPhone 14 Optimized) --- */
        .tab-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            /* å¢åŠ ä¸é€æ˜åº¦åˆ° 0.98ï¼Œç¢ºä¿çœ‹ä¸åˆ°åº•ä¸‹çš„ç°è‰² */
            background: rgba(255,255,255,0.98); 
            backdrop-filter: blur(30px) saturate(180%);
            -webkit-backdrop-filter: blur(30px) saturate(180%);
            border-top: 0.5px solid rgba(0,0,0,0.15);
            display: flex;
            justify-content: space-around;
            /* ç·Šæ¹Šä½ˆå±€ï¼šç¸®æ¸› padding-topï¼Œè®“å…§å®¹æ›´é è¿‘åº•éƒ¨ */
            padding-top: 6px; 
            /* ç›´æ¥ä½¿ç”¨ safe areaï¼Œä¸åŠ é¡å¤– pxï¼Œæ¸›å°‘ç™½è‰²å€åŸŸé«˜åº¦ */
            padding-bottom: env(safe-area-inset-bottom, 20px); 
            z-index: 100;
        }
        
        .tab-item {
            flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: #999; font-size: 10px; gap: 3px; cursor: pointer; transition: all 0.2s;
        }
        .tab-item.active { color: var(--theme-color); transform: translateY(-2px); }
        .tab-item.active svg { stroke-width: 2.5px; }

        .btn-action { display: inline-flex; align-items: center; gap: 8px; background: #f2f2f7; color: var(--theme-color); padding: 10px 20px; border-radius: 14px; font-size: 15px; font-weight: 600; text-decoration: none; margin-top: 15px; transition: transform 0.2s; }
        .btn-action:active { transform: scale(0.96); opacity: 0.8; }
    </style>
</head>
<body>

    <div class="bg-container">
        <div id="bg-itinerary" class="bg-image active"></div>
        <div id="bg-flights" class="bg-image" style="background-image: url('https://images.unsplash.com/photo-1569154941061-e231b4725ef1?q=80&w=1080');"></div>
        <div id="bg-hotels" class="bg-image" style="background-image: url('https://images.unsplash.com/photo-1618773928121-c32242e63f39?q=80&w=1080');"></div>
        <div id="bg-guide" class="bg-image" style="background-image: url('https://images.unsplash.com/photo-1501504905252-473c47e087f8?q=80&w=1080');"></div>
        <div class="bg-overlay"></div>
    </div>

    <header>
        <div class="header-left">
            <h1 id="header-title">è¡Œç¨‹</h1>
            <div class="subtitle" id="header-subtitle">Overview</div>
            <div id="countdown-banner">å³å°‡å‡ºç™¼ âœˆï¸</div>
        </div>
        <div class="weather-widget" id="header-weather-widget" onclick="openCurrentWeather()">
            <span class="weather-temp" id="current-temp">--Â°</span>
            <span class="weather-loc" id="current-loc">LOADING</span>
        </div>
    </header>

    <!-- TAB 1: ITINERARY -->
    <div id="tab-itinerary" class="content-area active">
        <div class="day-scroller-container"><div class="day-scroller"></div></div>
        <div id="day-content"></div>
    </div>

    <!-- TAB 2: FLIGHTS -->
    <div id="tab-flights" class="content-area">
        <div class="card animate-item">
            <div class="place-item no-arrow">
                <div class="place-header"><span class="place-name">SFO â LAS</span><span class="place-tag secondary">11/25 å»ç¨‹</span></div>
                <p class="place-desc"><strong>è¥¿å—èˆªç©º WN 3237</strong><br>Terminal 1 (Harvey Milk)</p>
                <div class="flight-time-row">
                    <div class="flight-time-col"><div class="ft-label">ç™»æ©Ÿ Board</div><div class="ft-time" style="color:#2980b9">09:50</div></div>
                    <div class="flight-time-col"><div class="ft-label">èµ·é£› Dep</div><div class="ft-time">10:20</div></div>
                    <i data-lucide="arrow-right" size="16" class="ft-icon"></i>
                    <div class="flight-time-col"><div class="ft-label">æŠµé” Arr</div><div class="ft-time">11:50</div></div>
                </div>
                <div class="lounge-info">
                    <div style="min-width:20px;"><i data-lucide="armchair" size="20" color="#002663"></i></div>
                    <div class="lounge-text">
                        <span class="lounge-badge">ç¾åœ‹é‹é€šè²´è³“å®¤</span><br>
                        <strong>SFO: Terminal 2</strong><br>
                        *Southwest åœ¨ T1ã€‚T1 èˆ‡ T2 æœ‰ Airside é€£é€šé“ï¼Œæ­¥è¡Œç´„ 5-10 åˆ†é˜ï¼Œä¸éœ€é‡éå®‰æª¢ã€‚<br>
                        <a href="https://queue.americanexpress.com/web/SFO_CENTURION_LOUNGE" target="_blank" style="color:#002663; font-weight:bold; text-decoration:underline; display:inline-block; margin-top:5px;">ğŸ‘‰ ç·šä¸ŠåŠ å…¥ç­‰å¾…åå–®</a>
                    </div>
                </div>
                <a href="https://www.flightaware.com/live/flight/SWA3237" target="_blank" class="btn-action" style="background:#f0f8ff; color:#2980b9"><i data-lucide="radar" size="16"></i> ç‹€æ…‹è¿½è¹¤</a>
            </div>
        </div>
        <div class="card animate-item">
            <div class="place-item no-arrow">
                <div class="place-header">
                    <span class="place-name">LAS â SFO</span>
                    <span class="place-tag secondary">12/1 å›ç¨‹</span>
                </div>
                <p class="place-desc"><strong>è¥¿å—èˆªç©º WN 2487</strong><br>Terminal 1 (Gates B/C)</p>
                <div class="flight-time-row">
                    <div class="flight-time-col"><div class="ft-label">ç™»æ©Ÿ Board</div><div class="ft-time" style="color:#2980b9">14:45</div></div>
                    <div class="flight-time-col"><div class="ft-label">èµ·é£› Dep</div><div class="ft-time">15:15</div></div>
                    <i data-lucide="arrow-right" size="16" class="ft-icon"></i>
                    <div class="flight-time-col"><div class="ft-label">æŠµé” Arr</div><div class="ft-time">16:50</div></div>
                </div>
                <div class="lounge-info">
                    <div style="min-width:20px;"><i data-lucide="armchair" size="20" color="#002663"></i></div>
                    <div class="lounge-text"><span class="lounge-badge">ç¾åœ‹é‹é€šè²´è³“å®¤</span><br><strong>LAS: Concourse D</strong><br>*éœ€æ­ä¹˜ Blue Line Tram å‰å¾€ D Gates (å®‰æª¢å€å…§)ã€‚</div>
                </div>
                <a href="https://www.flightaware.com/live/flight/SWA2487" target="_blank" class="btn-action" style="background:#f0f8ff; color:#2980b9"><i data-lucide="radar" size="16"></i> ç‹€æ…‹è¿½è¹¤</a>
            </div>
        </div>
        <div class="card animate-item">
            <div class="place-item no-arrow">
                <span class="place-name">LAS æ©Ÿå ´ç§Ÿè»Šä¸­å¿ƒ</span>
                <p class="place-desc" style="margin-top:5px;"><strong>å–è»Šï¼š</strong> 11/25 12:30 PM<br><strong>é‚„è»Šï¼š</strong> 11/28 ä¸‹åˆ (Vegas)</p>
                <a href="https://www.google.com/maps/search/?api=1&query=McCarran+Rent-A-Car+Center" target="_blank" class="btn-action" style="background:#f0f8ff; color:#2980b9"><i data-lucide="navigation"></i> å°èˆªå»å–è»Š</a>
            </div>
        </div>
    </div>

    <!-- TAB 3: HOTELS -->
    <div id="tab-hotels" class="content-area">
        <div class="card animate-item">
            <div class="place-item" onclick="openModal('Zion Inn', 'Springdale æº«é¦¨ä½å®¿', 'è·é›¢éŒ«å®‰å…¬åœ’å…¥å£åƒ…å¹¾åˆ†é˜è»Šç¨‹ã€‚é™„è¿‘æœ‰ä¸éŒ¯çš„é¤å»³å’Œè¶…å¸‚ã€‚')">
                <div class="place-header"><span class="place-name">Zion Inn</span><span class="place-tag highlight" style="background:#8e44ad">2 æ™š</span></div>
                <span class="hotel-date">11/25 (äºŒ) - 11/27 (å››)</span>
                <p class="place-desc">ğŸ“ 1215 Zion Park Blvd, Springdale</p>
                <a href="https://www.google.com/maps/search/?api=1&query=Zion+Inn,+1215+Zion+Park+Blvd,+Springdale,+UT" target="_blank" class="btn-action" style="background:#f8f4fc; color:#8e44ad" onclick="event.stopPropagation()"><i data-lucide="map-pin"></i> å°èˆª</a>
            </div>
        </div>
        <div class="card animate-item">
            <div class="place-item" onclick="openModal('Ruby\'s Inn', 'Bryce Canyon æ­·å²æ—…é¤¨', 'éå¸¸æœ‰è¥¿éƒ¨ç‰›ä»”é¢¨æƒ…çš„æ—…é¤¨ã€‚æ„Ÿæ©ç¯€æ™šé¤å°±åœ¨é€™è£¡åƒï¼æ—é‚Šæœ‰å¤§è¶…å¸‚ã€‚')">
                <div class="place-header"><span class="place-name">Ruby's Inn (Bryce)</span><span class="place-tag highlight" style="background:#8e44ad">1 æ™š</span></div>
                <span class="hotel-date">11/27 (å››) - 11/28 (äº”)</span>
                <p class="place-desc">ğŸ“ 26 S Main St, Bryce Canyon City</p>
                <a href="https://www.google.com/maps/search/?api=1&query=Best+Western+Plus+Ruby's+Inn,+26+South+Main+Street,+Bryce+Canyon+City,+UT" target="_blank" class="btn-action" style="background:#f8f4fc; color:#8e44ad" onclick="event.stopPropagation()"><i data-lucide="map-pin"></i> å°èˆª</a>
            </div>
        </div>
        <div class="card animate-item">
            <div class="place-item" onclick="openModal('Holiday Inn Express', 'Vegas ä½å®¿', 'ä½æ–¼ Tropicana å¤§é“ï¼Œé›¢ MGM Grand å¾ˆè¿‘ï¼Œæ–¹ä¾¿å»æ­ Monorail æˆ–èµ°åˆ° Strip å—ç«¯ã€‚é™„æ—©é¤ï¼')">
                <div class="place-header"><span class="place-name">Holiday Inn Express</span><span class="place-tag highlight" style="background:#8e44ad">3 æ™š</span></div>
                <span class="hotel-date">11/28 (äº”) - 12/1 (ä¸€)</span>
                <p class="place-desc">ğŸ“ 175 East Tropicana Ave, Vegas</p>
                <a href="https://www.google.com/maps/search/?api=1&query=Holiday+Inn+Express+Las+Vegas+-+South,+175+East+Tropicana+Ave,+Las+Vegas,+NV" target="_blank" class="btn-action" style="background:#f8f4fc; color:#8e44ad" onclick="event.stopPropagation()"><i data-lucide="map-pin"></i> å°èˆª</a>
            </div>
        </div>
    </div>

    <!-- TAB 4: GUIDE (Includes Prep) -->
    <div id="tab-guide" class="content-area">
        <div class="day-scroller-container"><div class="day-scroller" id="guide-scroller"></div></div>
        <div id="guide-content"></div>
    </div>

    <!-- MODAL -->
    <div class="modal-overlay" id="detail-modal" onclick="closeModal()">
        <div class="modal-sheet" onclick="event.stopPropagation()">
            <div class="modal-handle"></div>
            <button class="modal-close-btn" onclick="closeModal()">Ã—</button>
            <div class="modal-title" id="modal-title">Title</div>
            <div class="modal-desc" id="modal-desc">Description</div>
        </div>
    </div>

    <!-- TAB BAR -->
    <nav class="tab-bar">
        <div class="tab-item active" onclick="switchTab('itinerary', this)"><i data-lucide="map" size="24"></i><span>è¡Œç¨‹</span></div>
        <div class="tab-item" onclick="switchTab('flights', this)"><i data-lucide="plane" size="24"></i><span>äº¤é€š</span></div>
        <div class="tab-item" onclick="switchTab('hotels', this)"><i data-lucide="bed" size="24"></i><span>ä½å®¿</span></div>
        <div class="tab-item" onclick="switchTab('guide', this)"><i data-lucide="book-open" size="24"></i><span>æŒ‡å—</span></div>
    </nav>

    <script>
        lucide.createIcons();
        let currentHourlyTemps = [];
        let currentWeatherLoc = ""; // Store current location for click handler
        let currentHourlyCodes = []; // Store weather codes

        // --- DATA ---
        const daysData = [
            { date: "11/25", fullDate: "2025-11-25", week: "é€±äºŒ", title: "å‰å¾€éŒ«å®‰", color: "#D35400", bgImg: "https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?q=80&w=1080", weatherLoc: "Springdale", coords: "37.188,-112.998", mapUrl: "https://www.google.com/maps/dir/Harry+Reid+International+Airport/Costco+Wholesale,+Saint+George/Zion+National+Park+Visitor+Center/Zion+Inn,+Zion+Park+Boulevard,+Springdale,+UT", content: [
                { name: "æŠµé”è³­åŸ & å–è»Š", desc: "LAS æ©Ÿå ´ç§Ÿè»Šä¸­å¿ƒå–è»Šã€‚", tag: "12:30 PM", info: "å–è»Šæª¢æŸ¥ï¼šå‚™èƒã€å·¥å…·ã€ç©ºèª¿ã€‚" },
                { name: "St. George è£œçµ¦", desc: "Costco/Walmart è²·æ°´ã€æ—©é¤ã€‚", tag: "2:30 PM", info: "å»ºè­°è³¼è²·ï¼šæ•´ç®±æ°´ã€èƒ½é‡æ£’ã€æ°´æœã€ç°¡æ˜“å¾®æ³¢é£Ÿå“ã€‚" },
                { name: "Zion Visitor Center", desc: "è“‹å°ç«  (5PM é—œ)ã€‚", tag: "4:30 PM", info: "è©¢å• The Narrows æ°´ä½ç‹€æ³ã€‚" },
                { name: "Zion Inn ä½å®¿", desc: "é®ä¸Šæ™šé¤ï¼Œæ—©é»ä¼‘æ¯ã€‚", tag: "6:00 PM", info: "æ¨è–¦ï¼šThai Sapa æˆ– Oscar's Cafeã€‚" }
            ]},
            { date: "11/26", fullDate: "2025-11-26", week: "é€±ä¸‰", title: "éŒ«å®‰åœ‹å®¶å…¬åœ’", color: "#27AE60", bgImg: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?q=80&w=1080", weatherLoc: "Zion Park", coords: "37.298,-113.026", mapUrl: "https://www.google.com/maps/dir/Zion+Inn,+Zion+Park+Boulevard,+Springdale,+UT/Zion+National+Park+Visitor+Center/The+Grotto+Picnic+Area,+Zion+National+Park,+UT/Temple+of+Sinawava/Canyon+Overlook+Trail,+Zion-Mount+Carmel+Highway,+Springdale,+UT", shuttle: true, content: [
                { name: "æ­ä¹˜æ¥é§è»Š", desc: "ç›®æ¨™ç¬¬ä¸€ç­è»Šï¼", tag: "7:00 AM", info: "æ©˜ç·šè½‰ç¶ ç·šã€‚" },
                { name: "Angels Landing", desc: "ç¶ ç·š #6 The Grottoã€‚", tag: "8:00 AM", info: "èµ° West Rim Trail åˆ° Scout Lookoutã€‚" },
                { name: "Riverside Walk", desc: "é€šå¾€ Narrows çš„å¹³ç·©æ­¥é“ã€‚", tag: "è¼•é¬†", info: "æ²¿è‘—ç¶­ç´æ²³çš„å¹³ç·©æ­¥é“ï¼Œé€šå¾€ Narrows å…¥å£ã€‚" },
                { name: "The Narrows", desc: "ç¶ ç·š #9 Temple of Sinawavaã€‚", tag: "11:00 AM", info: "æ²³æ¿±æ­¥é“èµ°åˆ°åº•ã€‚" },
                { name: "Emerald Pools", desc: "ç¶ ç·š #5 Zion Lodgeã€‚", tag: "2:00 PM", info: "Lower Pool æœ‰ç€‘å¸ƒæ°´ç°¾ã€‚" },
                { name: "Canyon Overlook", desc: "âš ï¸ éœ€é–‹è»Šã€‚ééš§é“å¾Œåœè»Šã€‚", tag: "5:00 PM", info: "çœ‹å…¨æ™¯æœ€ä½³é»ã€‚" },
                { name: "Pa'rus Trail", desc: "çœ‹ The Watchman æ—¥è½æœ€ç¾ã€‚", tag: "æ—¥è½", info: "å”¯ä¸€å¯é¨è‡ªè¡Œè»Šçš„æ­¥é“ï¼Œè¦–é‡é–‹é—Šã€‚" }
            ]},
            { date: "11/27", fullDate: "2025-11-27", week: "é€±å››", title: "å¸ƒèŠæ–¯å³½è°·", color: "#C0392B", bgImg: "https://images.unsplash.com/photo-1546587348-d12660c30c50?q=80&w=1080", weatherLoc: "Bryce Canyon", coords: "37.628,-112.167", mapUrl: "https://www.google.com/maps/dir/Springdale+Zion+Inn,+1215+Zion+Park+Blvd,+Springdale,+UT/Bryce+Canyon+National+Park+Visitor+Center/Sunset+Point,+Bryce+Canyon,+UT/Inspiration+Point,+Bryce+Canyon,+UT/Best+Western+Plus+Ruby's+Inn,+South+Main+Street,+Bryce+Canyon+City,+UT", content: [
                { name: "12 è™Ÿæ™¯è§€å…¬è·¯", desc: "é¢¨æ™¯çµ•ç¾ä½†å½æ›²ã€‚", tag: "9:00 AM", info: "ç¶“é Red Canyonã€‚" },
                { name: "Natural Bridge", desc: "å·¨å¤§çš„ç´…è‰²å¤©ç„¶æ‹±é–€ã€‚", tag: "æ‹ç…§", info: "ä½æ–¼æ™¯è§€å…¬è·¯ä¸­æ®µï¼Œè‰²å½©å°æ¯”å¼·çƒˆã€‚" },
                { name: "Bryce è§€æ™¯å°", desc: "éŠå®¢ä¸­å¿ƒ â” Sunset â” Inspirationã€‚", tag: "12:00 PM", info: "çœ‹ Hoodoos çŸ³ä¿‘ã€‚" },
                { name: "Queens Garden", desc: "èµ°å…¥çŸ³æ—åº•éƒ¨ã€‚", tag: "å¿…èµ°", info: "é€£æ¥ Navajo Loop çš„æœ€ä½³é¸æ“‡ã€‚" },
                { name: "Navajo Loop", desc: "èµ°å…¥å³½è°·çœ‹é›·ç¥ä¹‹éšã€‚", tag: "2:00 PM", info: "è‘—åçš„ Wall Street å€æ®µã€‚" },
                { name: "Rainbow Point", desc: "å…¬è·¯ç›¡é ­çš„æœ€é«˜é»ã€‚", tag: "è‡³é«˜é»", info: "æµ·æ‹” 9100 è‹±å°ºï¼Œä¿¯ç°æ•´å€‹å³½è°·ã€‚" },
                { name: "æ„Ÿæ©ç¯€æ™šé¤", desc: "å…¥ä½ Ruby's Innã€‚", tag: "6:00 PM", info: "Cowboy Buffet æˆ–è‡ªå‚™å¤§é¤ã€‚" }
            ]},
            { date: "11/28", fullDate: "2025-11-28", week: "é€±äº”", title: "ç«ç„°è°· & è³­åŸ", color: "#8E44AD", bgImg: "https://images.unsplash.com/photo-1548954047-3f42a6776b62?q=80&w=1080", weatherLoc: "Las Vegas", coords: "36.169,-115.139", mapUrl: "https://www.google.com/maps/dir/Best+Western+Plus+Ruby's+Inn/Valley+of+Fire+State+Park/Sahara+Las+Vegas", content: [
                { name: "Valley of Fire", desc: "ç«ç„°è°·å·ç«‹å…¬åœ’ã€‚", tag: "10:00 AM", info: "å¿…çœ‹ Fire Waveã€‚" },
                { name: "æŠµé” Vegas & é‚„è»Š", desc: "å…ˆæ”¾è¡Œæå†é‚„è»Šã€‚", tag: "3:00 PM", info: "Holiday Inn Check-inã€‚" },
                { name: "Magic Mike Live", desc: "Sahara Hotelã€‚", tag: "10:00 PM", info: "ææ—©å…¥å ´ã€‚" }
            ]},
            { date: "11/29", fullDate: "2025-11-29", week: "é€±å…­", title: "è³­åŸå¤§ç§€", color: "#F1C40F", bgImg: "https://images.unsplash.com/photo-1605833556294-ea5c7a74f57d?q=80&w=1080", weatherLoc: "Las Vegas", coords: "36.169,-115.139", mapUrl: "https://www.google.com/maps/search/Las+Vegas+Strip", content: [
                { name: "é£¯åº—å·¡ç¦®", desc: "Bellagio, Venetianã€‚", tag: "ç™½å¤©", info: "æ°´èˆã€é‹æ²³ã€‚" },
                { name: "MJ One", desc: "Mandalay Bayã€‚", tag: "6:30 PM", info: "å¤ªé™½é¦¬æˆ²åœ˜ç¶“å…¸ã€‚" },
                { name: "X Country", desc: "Harrah'sã€‚", tag: "10:00 PM", info: "ä¸Šç©ºé„‰æ‘æ­Œèˆã€‚" }
            ]},
            { date: "11/30", fullDate: "2025-11-30", week: "é€±æ—¥", title: "æœ€å¾Œæ¢ç´¢", color: "#2980B9", bgImg: "https://images.unsplash.com/photo-1581351123004-757980748d20?q=80&w=1080", weatherLoc: "Las Vegas", coords: "36.169,-115.139", mapUrl: "https://www.google.com/maps/search/Fremont+Street+Experience", content: [
                { name: "Fremont Street", desc: "èˆŠåŸå€å¤©å¹•ç§€ã€‚", tag: "æ™šé–“", info: "æ°£æ°›ç‹‚é‡ï¼ŒLED å¤©å¹•ã€‚" },
                { name: "ä¼´æ‰‹ç¦®", desc: "M&M, Coca-Colaã€‚", tag: "è‡ªç”±", info: "æœ€å¾Œæ¡è²·ã€‚" }
            ]},
            { date: "12/1", fullDate: "2025-12-01", week: "é€±ä¸€", title: "è¿”ç¨‹", color: "#7F8C8D", bgImg: "https://images.unsplash.com/photo-1436491865332-7a61a109cc05?q=80&w=1080", weatherLoc: "SFO", coords: "37.621,-122.379", mapUrl: "https://www.google.com/maps/dir/Holiday+Inn+Express/Harry+Reid+International+Airport", content: [
                { name: "å‰å¾€æ©Ÿå ´", desc: "æ­ Uber/Lyftã€‚", tag: "å›ç¨‹", info: "é ç•™å®‰æª¢æ™‚é–“ã€‚" },
                { name: "é£›å› SFO", desc: "WN 2487ã€‚", tag: "é£›è¡Œ", info: "æ”¶å¿ƒä¸Šç­ï¼" }
            ]}
        ];

        const guideData = [
            { category: "ğŸ’ è¡Œå‰/æ‰“åŒ…", id: "prep", content: [] },
            { category: "â›°ï¸ éŒ«å®‰", content: [
                { name: "Checkerboard Mesa", tag: "åœ°è³ª", desc: "åƒæ£‹ç›¤ä¸€æ¨£çš„å²©å±±ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™æ˜¯æ±å´å…¥å£æœ€é†’ç›®çš„åœ°æ¨™ã€‚å²©çŸ³è¡¨é¢å› ç‚ºé¢¨è•å’Œå‡èä½œç”¨ï¼Œå½¢æˆäº†å‚ç›´å’Œæ°´å¹³çš„æºæ§½ï¼Œçœ‹èµ·ä¾†å°±åƒå·¨å¤§çš„æ£‹ç›¤ã€‚\n\nğŸ“ **ä½ç½®ï¼š**\næ±å´å…¥å£æ”¶è²»ç«™å‰›é€²ä¾†å°±æœƒçœ‹åˆ°ã€‚" },
                { name: "Kolob Canyons", tag: "ç§˜å¢ƒ", desc: "äººå°‘æ™¯ç¾çš„ç´…è‰²æ‰‹æŒ‡ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™è£¡ä¸åœ¨ä¸»å³½è°·å€ï¼Œè€Œæ˜¯åœ¨å…¬åœ’è¥¿åŒ—è§’ï¼ˆI-15 å…¬è·¯æ—ï¼‰ã€‚éŠå®¢éå¸¸å°‘ï¼Œå·¨å¤§çš„ç´…è‰²ç´ç“¦éœç ‚å²©åƒæ‰‹æŒ‡ä¸€æ¨£ä¼¸å‘å¤©ç©ºï¼Œéå¸¸å£¯è§€ã€‚\n\nğŸš— **äº¤é€šï¼š**\néœ€è¦é–‹è»Šå‰å¾€ï¼Œç„¡æ³•å¾ä¸»å³½è°·æ­ Shuttle åˆ°é”ã€‚" },
                { name: "åœ°è³ªèµ·æº", tag: "å¿…è®€", desc: "å¤ä»£æ²™ä¸˜è®Šæˆçš„ç´…è‰²å·¨å²©ã€‚", info: "ğŸ’¬ **ç°¡å–®èªªï¼š**\né€™è£¡ä»¥å‰æ˜¯åƒæ’’å“ˆæ‹‰æ²™æ¼ ä¸€æ¨£çš„è¶…å¤§æ²™å‘ï¼å¾Œä¾†è®Šæˆäº†çŸ³é ­ï¼Œåˆè¢«æ²³æ°´åˆ‡è›‹ç³•ä¸€æ¨£åˆ‡é–‹ï¼Œå°±è®Šæˆäº†ç¾åœ¨å£¯è§€çš„æ¨£å­ã€‚\n\nğŸ¤“ **å†·çŸ¥è­˜ï¼š**\né‚£äº›å·¨å¤§çš„ç´…è‰²å²©å£ï¼Œå…¶å¯¦æ˜¯1.5å„„å¹´å‰çš„ä¸€å€‹è¶…ç´šå¤§æ²™æ¼ ã€‚æ²™å­ä¸€å±¤å±¤å †ç–Šï¼Œæœ€å¾Œè®Šæˆäº†çŸ³é ­ã€‚" },
                { name: "Angels Landing", tag: "å¿ƒè·³åŠ é€Ÿ", desc: "å¿ƒè·³æ¼ä¸€æ‹çš„æŒ‘æˆ°ï¼", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\næŒ‘æˆ°ä½ çš„è†½é‡æ¥µé™ï¼æŠ“è‘—éµéŠèµ°åœ¨æ‡¸å´–é‚Šï¼Œå¿ƒè·³åŠ é€Ÿä½†é¢¨æ™¯ç„¡æ•µã€‚\n\nâš ï¸ **æ³¨æ„ï¼š**\næ‡¼é«˜ç—‡æ‚£è€…è«‹ä¸‰æ€ï¼Œæˆ–è€…åœ¨ Scout Lookout åƒç“œçœ‹åˆ¥äººçˆ¬å°±å¥½ã€‚" },
                { name: "The Narrows", tag: "ç¨ç‰¹é«”é©—", desc: "èµ°é€²æ²³è£¡å»å†’éšªã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™ä¸æ˜¯ã€Œçœ‹ã€å³½è°·ï¼Œè€Œæ˜¯ã€Œèµ°é€²ã€å³½è°·è£¡ã€‚è…³è¸©åœ¨æ°´è£¡ï¼ŒæŠ¬é ­æ˜¯åƒå°ºé«˜çš„ä¸€ç·šå¤©ï¼Œé€™ç¨®é«”é©—å…¨ä¸–ç•Œæ²’å¹¾å€‹åœ°æ–¹æœ‰ã€‚\n\nğŸ’ **è£å‚™ï¼š**\nå†¬å¤©æ°´æº«æ¥µä½ï¼Œä¸€å®šè¦ç§Ÿ dry suit (ä¹¾å¼é˜²å¯’è¡£)ã€‚" },
                { name: "Emerald Pools", tag: "è¼•é¬†", desc: "å»çœ‹ç€‘å¸ƒæ°´ç°¾æ´ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™æ˜¯ä¸€æ¢å¾ˆæº«æŸ”çš„æ­¥é“ã€‚Lower Pool æœ‰å€‹æ°´ç°¾æ´ï¼Œä½ å¯ä»¥èµ°åˆ°ç€‘å¸ƒå¾Œé¢ï¼Œå¾ˆé©åˆæ‹æœ‰æ„å¢ƒçš„ç…§ç‰‡ã€‚" },
                { name: "Canyon Overlook", tag: "CPå€¼é«˜", desc: "ä¸ç”¨çˆ¬å¾—åŠæ­»ä¹Ÿèƒ½çœ‹å¤§æ™¯ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\nCPå€¼æœ€é«˜ï¼åªè¦èµ° 20 åˆ†é˜ï¼Œå°±èƒ½çœ‹åˆ°è·Ÿ Angels Landing ä¸€æ¨£å£¯è§€çš„é¢¨æ™¯ï¼Œè€Œä¸”ä¸ç”¨æŠ½ç±¤ã€ä¸ç”¨çˆ¬æ‡¸å´–ã€‚" },
                { name: "Watchman Trail", tag: "äººå°‘", desc: "é¿é–‹äººæ½®çš„å¥½é¸æ“‡ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\nå¦‚æœä½ ç¬¬ä¸€å¤©ä¸‹åˆå‰›åˆ°ï¼Œä¸æƒ³å¤ªç´¯ï¼Œé€™æ¢æ­¥é“å°±åœ¨éŠå®¢ä¸­å¿ƒæ—ï¼Œå¯ä»¥çœ‹å¤•é™½ç…§åœ¨ Watchman å±±å³°ä¸Šçš„é‡‘å…‰ã€‚" },
                { name: "Court of the Patriarchs", tag: "æ‹ç…§", desc: "ä¸‹è»Šå°±èƒ½æ‹å¤§ç‰‡ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™æ˜¯ä¸€å€‹åªè¦ä¸‹è»Šèµ° 2 åˆ†é˜å°±èƒ½åˆ°çš„è§€æ™¯å°ã€‚å¯ä»¥ä¸€æ¬¡æ‹åˆ°ä¸‰åº§ä»¥è–ç¶“äººç‰©å‘½åçš„é«˜å³°ã€‚" }
            ]},
            { category: "ğŸšŒ éŒ«å®‰æ¥é§è»Š", content: [
                { name: "æ¥é§è»Šç³»çµ±ä»‹ç´¹", tag: "å¿…è®€", desc: "åˆ†ç‚ºå…¬åœ’å…§ç¶ ç·šèˆ‡å¸‚å€æ©˜ç·šã€‚", info: "éŒ«å®‰åœ‹å®¶å…¬åœ’æœ‰å…©æ¢æ¥é§è»Šè·¯ç·šï¼š\n1. **ğŸŸ¢ ç¶ ç·š (Zion Canyon Line)**ï¼šåœ¨å…¬åœ’å…§éƒ¨é‹è¡Œï¼Œé€£æ¥éŠå®¢ä¸­å¿ƒèˆ‡å„å€‹ç™»å±±å£ã€‚\n2. **ğŸŸ  æ©˜ç·š (Springdale Line)**ï¼šåœ¨ Springdale é®ä¸Šé‹è¡Œï¼Œé€£æ¥å„é£¯åº—èˆ‡å…¬åœ’å…¥å£ã€‚\n\nğŸ’¡ **è½‰ä¹˜æ–¹å¼ï¼š**\næ­æ©˜ç·šåˆ°çµ‚é»ç«™ (Zion Canyon Village)ï¼Œä¸‹è»Šæ­¥è¡Œé€šéå…¥å£é–˜é–€ï¼Œå†èµ°åˆ°éŠå®¢ä¸­å¿ƒæ­ä¹˜ç¶ ç·šã€‚" },
                { name: "ğŸŸ¢ ç¶ ç·š (Zion Canyon Line)", tag: "åœ’å…§", desc: "éŠå®¢ä¸­å¿ƒ â‡„ Temple of Sinawava", info: "ä¸»è¦ç«™é»ï¼š\n#1 Visitor Center (èµ·é»)\n#3 Canyon Junction\n#5 Zion Lodge (Emerald Pools)\n#6 The Grotto (Angels Landing)\n#9 Temple of Sinawava (The Narrows)\n\nâ° **æ™‚é–“ï¼š**\né€šå¸¸æ¯ 10-15 åˆ†é˜ä¸€ç­ã€‚æ—©æ™¨äººæ½®çœ¾å¤šï¼Œå»ºè­° 7:00 AM å‰æŠµé”ã€‚" },
                { name: "ğŸŸ  æ©˜ç·š (Springdale Line)", tag: "å¸‚å€", desc: "Springdale â‡„ å…¬åœ’å…¥å£", info: "ä¸»è¦åŠŸèƒ½ï¼š\nå…è²»æ¥é€éŠå®¢å¾é£¯åº—åˆ°å…¬åœ’å…¥å£ã€‚å¦‚æœä½ ä½åœ¨ Springdaleï¼Œè«‹æŠŠè»Šåœåœ¨é£¯åº—ï¼Œç›´æ¥æ­é€™ç­è»Šã€‚\n\nğŸ“ **ç«™é»ï¼š**\næ²¿è‘— Zion Park Blvd æœ‰ 9 å€‹ç«™é»ï¼ŒZion Inn é™„è¿‘å°±æœ‰ç«™ç‰Œã€‚" },
                { name: "ç«™é» #1: Visitor Center", tag: "ç¶ ç·š", desc: "èµ·é»ã€å»æ‰€ã€æ°´ç«™ã€‚", info: "é€™è£¡æ˜¯æ‰€æœ‰ç¶ ç·šæ¥é§è»Šçš„èµ·é»ã€‚æœ‰å¤§å‹åœè»Šå ´ï¼ˆé€šå¸¸å¾ˆæ—©å°±æ»¿äº†ï¼‰ï¼Œé‚„æœ‰éŠå®¢ä¸­å¿ƒå¯ä»¥è«®è©¢ Rangerã€è£æ°´ã€ä¸Šå»æ‰€ã€‚" },
                { name: "ç«™é» #6: The Grotto", tag: "ç¶ ç·š", desc: "Angels Landing èµ·é»ã€‚", info: "è¦çˆ¬ Angels Landing æˆ– West Rim Trail çš„è«‹åœ¨é€™è£¡ä¸‹è»Šã€‚é€™è£¡ä¹Ÿæœ‰é‡é¤å€å’Œå»æ‰€ã€‚" },
                { name: "ç«™é» #9: Temple of Sinawava", tag: "ç¶ ç·š", desc: "The Narrows èµ·é»ã€‚", info: "ç¶ ç·šçš„çµ‚é»ç«™ã€‚ä¸‹è»Šå¾Œæ²¿è‘— Riverside Walk èµ°åˆ°åº•ï¼Œå°±æ˜¯ The Narrows çš„å…¥å£ã€‚" },
                { name: "å®˜æ–¹åœ°åœ– PDF", tag: "ä¸‹è¼‰", desc: "é»æ“ŠæŸ¥çœ‹ NPS å®˜æ–¹å†¬å­£æŒ‡å—ã€‚", info: "ğŸ”— **é€£çµï¼š**\n<a href='https://www.nps.gov/zion/planyourvisit/upload/25-26Winter-InfoGuide.pdf' target='_blank' style='color:blue;text-decoration:underline;'>é»æ­¤æ‰“é–‹ NPS å®˜æ–¹ PDF åœ°åœ–</a>\n\né€™ä»½æŒ‡å—åŒ…å«è©³ç´°çš„æ¥é§è»Šåœ°åœ–ã€æ™‚åˆ»è¡¨ä»¥åŠå„å€‹æ­¥é“çš„é–‹æ”¾ç‹€æ³ã€‚" }
            ]},
            { category: "ğŸŒ² å¸ƒèŠæ–¯", content: [
                { name: "Natural Bridge", tag: "æ‹ç…§", desc: "å·¨å¤§çš„å¤©ç„¶æ‹±é–€ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né›–ç„¶å«ã€Œæ©‹ã€ï¼Œä½†å…¶å¯¦æ˜¯å€‹ä¾µè•å‡ºä¾†çš„ã€Œæ‹±é–€ã€ã€‚ç´…è‰²çš„å²©çŸ³æ‹±é–€æ¡†ä½èƒŒå¾Œæ·±ç¶ è‰²çš„æ¾æ¨¹æ—ï¼Œå°æ¯”éå¸¸å¼·çƒˆï¼Œæ˜¯æ”å½±å¸«çš„æœ€æ„›ã€‚" },
                { name: "Rainbow Point", tag: "è‡³é«˜é»", desc: "æ•´å€‹å…¬åœ’çš„æœ€é«˜é»ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\nä½æ–¼æ™¯è§€å…¬è·¯çš„ç›¡é ­ï¼ˆæµ·æ‹” 9100 è‹±å°ºï¼‰ã€‚å¾é€™è£¡å¯ä»¥å›æœ›æ•´å€‹å¸ƒèŠæ–¯éœ²å¤©åŠ‡å ´ï¼Œå¤©æ°£å¥½ç”šè‡³èƒ½çœ‹åˆ°äºåˆ©æ¡‘é‚£å·ã€‚\n\nğŸ§¥ **æ³¨æ„ï¼š**\né€™è£¡é€šå¸¸æ¯”éŠå®¢ä¸­å¿ƒæ›´å†·ï¼Œé¢¨ä¹Ÿæ›´å¤§ã€‚" },
                { name: "Mossy Cave", tag: "ç§˜å¢ƒ", desc: "æœ‰ç€‘å¸ƒçš„å°æ­¥é“ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™æ¢æ­¥é“ä¸åœ¨å…¬åœ’æ”¶è²»ç«™å…§ï¼ˆä½æ–¼ 12 è™Ÿå…¬è·¯ä¸Šï¼‰ã€‚é€™è£¡æœ‰ä¸€æ¢å°æºªå’Œç€‘å¸ƒï¼ˆå†¬å¤©å¯èƒ½çµå†°ï¼‰ï¼Œé‚„æœ‰ä¸€å€‹é•·æ»¿è‹”è˜šçš„æ´ç©´ï¼Œéå¸¸ç‰¹åˆ¥ã€‚" },
                { name: "åœ°è³ªèµ·æº", tag: "å¿…è®€", desc: "è¢«å†°é›ªé‘¿å‡ºçš„éœ²å¤©åŠ‡å ´ã€‚", info: "ğŸ’¬ **ç°¡å–®èªªï¼š**\né€™è£¡çš„çŸ³é ­é•·å¾—åƒä¸€ç¾¤ç«™ç«‹çš„äººï¼Œå«åš Hoodoosã€‚å‚³èªªæ˜¯è¢«è®ŠæˆçŸ³é ­çš„å¤ä»£äººï¼Œå…¶å¯¦æ˜¯å†°é›ªé›•åˆ»å‡ºä¾†çš„å‚‘ä½œã€‚\n\nğŸ¤“ **å†·çŸ¥è­˜ï¼š**\næ°´æ»²é€²ç¸«éš™ï¼Œæ™šä¸Šçµå†°è†¨è„¹æŠŠçŸ³é ­æ’é–‹ï¼Œé€™éç¨‹é‡è¤‡äº†å¹¾ç™¾è¬æ¬¡ã€‚" },
                { name: "Sunset Point", tag: "ç†±é–€", desc: "çœ‹é›·ç¥ä¹‹éšçš„æœ€ä½³ä½ç½®ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né›–ç„¶å«æ—¥è½é»ï¼Œä½†å…¶å¯¦ä»»ä½•æ™‚å€™ä¾†éƒ½ç¾ã€‚é€™è£¡å¾€ä¸‹çœ‹ï¼ŒçŸ³ä¿‘æœ€å¯†é›†ï¼Œé‚£å€‹è‘—åçš„ã€Œé›·ç¥ä¹‹éšã€å°±åœ¨æ­£ä¸‹æ–¹ã€‚" },
                { name: "Inspiration Point", tag: "å£¯è§€", desc: "åƒç¾…é¦¬ç«¶æŠ€å ´ä¸€æ¨£å£¯è§€ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™è£¡æ²’æœ‰æ­¥é“å¾€ä¸‹èµ°ï¼Œæ‰€ä»¥è¦–é‡æ²’æœ‰é®æ“‹ã€‚ä½ æœƒæ„Ÿè¦ºè‡ªå·±ç«™åœ¨ä¸€å€‹å·¨å¤§çš„ç¾…é¦¬ç«¶æŠ€å ´é‚Šç·£ï¼Œçœ‹è‘—åº•ä¸‹çš„å¥‡å²©æ€ªçŸ³ã€‚" },
                { name: "Navajo Loop", desc: "èµ°é€²ã€Œè¯çˆ¾è¡—ã€ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™æ˜¯å¸ƒèŠæ–¯æœ€ç¶“å…¸çš„æ­¥é“ã€‚ä½ æœƒèµ°é€²ä¸€å€‹å«ã€Œè¯çˆ¾è¡—ã€çš„å³½è°·ï¼Œå…©é‚Šçš„å²©å£é«˜è³å…¥é›²ï¼Œåªæœ‰å¹¾æ£µå€”å¼·çš„æ¾æ¨¹é•·åœ¨é‚£è£¡ã€‚" },
                { name: "Queens Garden", tag: "æœ‰è¶£", desc: "å»æ‰¾ç¶­å¤šåˆ©äºå¥³ç‹ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™æ¢è·¯æ¯”è¼ƒå¹³ç·©ï¼Œå¯ä»¥è®“ä½ è¿‘è·é›¢æ‘¸åˆ°é‚£äº›çŸ³æŸ±ã€‚çµ‚é»æœ‰ä¸€åº§çŸ³åƒé•·å¾—è¶…åƒç¶­å¤šåˆ©äºå¥³ç‹ï¼ˆé›–ç„¶éœ€è¦ä¸€é»æƒ³åƒåŠ›ğŸ˜†ï¼‰ã€‚" }
            ]},
            { category: "ğŸ”¥ ç«ç„°è°·", content: [
                { name: "Fire Wave", tag: "ç¶²ç´…", desc: "åƒåŸ¹æ ¹ä¸€æ¨£çš„æ³¢æµªå²©ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™æ˜¯å…¬åœ’æœ€è‘—åçš„æ™¯é»ã€‚ç´…ç™½ç›¸é–“çš„æ¢ç´‹å²©çŸ³ï¼Œåƒæµ·æµªä¸€æ¨£èµ·ä¼ã€‚å¤•é™½æ™‚åˆ†é¡è‰²æœ€é®®è±”ï¼Œéš¨ä¾¿æ‹éƒ½æ˜¯å¤§ç‰‡ã€‚\n\nâš ï¸ **æ³¨æ„ï¼š**\næ­¥é“é›–ç„¶ä¸é•·ï¼Œä½†å®Œå…¨ç„¡é®è”½ï¼Œè«‹å¸¶è¶³å¤ çš„æ°´ã€‚" },
                { name: "White Domes", tag: "é›»å½±", desc: "è‰²å½©è±å¯Œçš„ç‹¹ç¸«å³½è°·ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™è£¡æ›¾ç¶“æ˜¯é›»å½±ã€Šæ˜Ÿè‰¦è¿·èˆªè¨˜ã€‹çš„æ‹æ”åœ°ã€‚æ­¥é“æœƒç¶“éä¸€å€‹å°å‹çš„ç‹¹ç¸«å³½è°· (Slot Canyon)ï¼Œå²©çŸ³é¡è‰²å¾ç™½è‰²ã€é»ƒè‰²åˆ°ç´…è‰²éƒ½æœ‰ï¼Œéå¸¸å¤¢å¹»ã€‚" },
                { name: "Elephant Rock", tag: "å¥‡å²©", desc: "çœŸçš„åƒä¸€é ­å¤§è±¡ï¼", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\nå°±åœ¨æ±å´å…¥å£è·¯é‚Šã€‚é€™å¡Šç´…å²©ç¶“éé¢¨åŒ–ï¼Œé•·å¾—è·Ÿå¤§è±¡ä¸€æ¨¡ä¸€æ¨£ï¼Œé•·é•·çš„é¼»å­é€£è‘—åœ°é¢ï¼Œéå¸¸å¯æ„›ã€‚" },
                { name: "Mouse's Tank", tag: "æ­·å²", desc: "å°‹æ‰¾å¤ä»£å²©ç•«ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™æ˜¯ä¸€æ¢æ²™åœ°æ­¥é“ã€‚æ²¿é€”çš„é»‘è‰²å²©å£ä¸Šåˆ»æ»¿äº†å¹¾åƒå¹´å‰åŸä½æ°‘ç•™ä¸‹çš„å²©ç•« (Petroglyphs)ã€‚ä»”ç´°æ‰¾æ‰¾ï¼Œä½ èƒ½çœ‹åˆ°åƒç¾Šã€äººæ‰‹å°çš„åœ–æ¡ˆã€‚" }
            ]},
            { category: "ğŸ° è³­åŸåœ°æ¨™", content: [
                { name: "The Sphere", tag: "å¿…çœ‹", desc: "ç›¯è‘—ä½ çœ‹çš„å·¨å‹çƒé«”ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™æ˜¯ç›®å‰æ‹‰æ–¯ç¶­åŠ æ–¯æœ€ç«çš„åœ°æ¨™ï¼ä¸–ç•Œä¸Šæœ€å¤§çš„çƒå‹ LED è¢å¹•ã€‚å®ƒæœƒè®Šæˆå·¨å¤§çš„è¡¨æƒ…ç¬¦è™Ÿã€çœ¼çƒã€æˆ–æœˆçƒã€‚æœ€ä½³è§€è³é»æ˜¯åœ¨å–®è»Œé›»è»Šä¸Šæˆ–é™„è¿‘çš„åœè»Šå ´ã€‚" },
                { name: "Welcome Sign", tag: "æ‰“å¡", desc: "æ²’æ‹é€™å¼µä¸ç®—ä¾†éè³­åŸã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né‚£å¡Š 'Welcome to Fabulous Las Vegas' çš„æ‹›ç‰Œã€‚ä½æ–¼ Strip çš„æœ€å—ç«¯ã€‚\n\nğŸ’¡ **å°æ’‡æ­¥ï¼š**\næ’éšŠæ‹ç…§çš„äººé€šå¸¸å¾ˆå¤šã€‚å¦‚æœä½ ä¸æƒ³æ’éšŠï¼Œå¯ä»¥ç«™åœ¨æ—é‚Šæ–œä¸€é»çš„è§’åº¦æ‹ï¼Œæ•ˆæœä¹Ÿä¸éŒ¯ï¼" },
                { name: "High Roller", tag: "æ‘©å¤©è¼ª", desc: "å…¨çƒæœ€é«˜çš„æ‘©å¤©è¼ªä¹‹ä¸€ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\nè½‰ä¸€åœˆè¦ 30 åˆ†é˜ã€‚ä½ å¯ä»¥åŒ…ä¸‹ä¸€å€‹è»Šå»‚ï¼Œç”šè‡³æœ‰é™„å¸¶èª¿é…’å¸«çš„è»Šå»‚ (Happy Half Hour)ï¼Œé‚Šå–é…’é‚Šçœ‹å¤œæ™¯ã€‚" },
                { name: "Area15", tag: "é…·", desc: "èµ°é€²ç•°æ¬¡å…ƒè¶…å¸‚ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™è£¡æœ‰è‘—åçš„ Omega Martï¼ˆå–µå–µè¶…å¸‚ï¼‰ã€‚çœ‹èµ·ä¾†åƒæ™®é€šè¶…å¸‚ï¼Œä½†æ‰“é–‹å†°ç®±é–€æœƒé€šå¾€ç•°ä¸–ç•Œã€‚å……æ»¿äº†äº’å‹•è—è¡“å’Œè¿·å¹»è£ç½®ï¼Œéå¸¸é©åˆå¹´è¼•äººã€‚" },
                { name: "Bellagio", tag: "ç¶“å…¸", desc: "é›»å½±è£¡çš„ç¶“å…¸æ°´èˆã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™å°±æ˜¯é›»å½±ã€Šçå¤©éæµ·ã€‹æœ€å¾Œå¤§å®¶çœ‹æ°´èˆçš„åœ°æ–¹ã€‚é‚£ç¨®å„ªé›…çš„æ°›åœæ˜¯è³­åŸå…¶ä»–åœ°æ–¹å­¸ä¸ä¾†çš„ã€‚è¨˜å¾—é€²å»çœ‹æº«å®¤èŠ±åœ’ï¼Œé‚£äº›èŠ±éƒ½æ˜¯çœŸçš„ï¼" },
                { name: "Venetian", tag: "å¨å°¼æ–¯", desc: "å‡å¤©ç©ºåšå¾—å¤ªåƒçœŸçš„ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né›–ç„¶å¾ˆæµ®èª‡ï¼Œä½†é‚£å€‹å®¤å…§é‹æ²³å’Œå‡å¤©ç©ºçœŸçš„åšå¾—å¤ªå¥½äº†ã€‚åœ¨é‹æ²³é‚Šè½èˆ¹å¤«å”±ç¾©å¤§åˆ©æ­ŒåŠ‡ï¼Œæ°£æ°›æ»¿åˆ†ã€‚" },
                { name: "Circa Resort", tag: "å¤§äººé™å®š", desc: "æ²’æœ‰å°å­©çš„å¿«æ¨‚å¤©å ‚ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™æ˜¯ Downtown æœ€æ–°çš„è³­å ´ï¼Œè€Œä¸”ä¸æº–å°å­©é€²å»ï¼é ‚æ¨“çš„ Stadium Swim æœ‰è¶…å¤§è¢å¹•å¯ä»¥é‚Šæ¸¸æ³³é‚Šçœ‹çƒè³½ï¼Œéå¸¸ç¾å¼é¢¨æ ¼ã€‚" },
                { name: "Resorts World", tag: "åƒè²¨", desc: "äºæ´²ç¾é£Ÿå¤§é›†åˆã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\nå¦‚æœä½ æ‡·å¿µäºæ´²é£Ÿç‰©ï¼Œé€™è£¡ä¸€å®šè¦ä¾†ã€‚Famous Foods Street Eats é›†åˆäº†å„ç¨®äºæ´²ç±³å…¶æ—å°åƒï¼Œåƒé«˜ç´šç‰ˆçš„å¤œå¸‚ã€‚" },
                { name: "The STRAT", tag: "åˆºæ¿€", desc: "åœ¨å¡”é ‚å°–å«ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\nå¦‚æœä½ è†½å­å¤§ï¼Œé ‚æ¨“æœ‰æ‡¸ç©ºåœ¨å¡”å¤–çš„éŠæ¨‚è¨­æ–½ã€‚å¦‚æœè†½å­å°ï¼Œå»è§€æ™¯å°å–æ¯é…’çœ‹å¤œæ™¯ä¹Ÿå¾ˆæ£’ã€‚" },
                { name: "Red Rock", tag: "æ”¾é¬†", desc: "é é›¢å¡µå›‚çš„åº¦å‡æ„Ÿã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né€™æ˜¯åœ¨åœ°æœ‰éŒ¢äººå»çš„åœ°æ–¹ã€‚é›¢ Strip æœ‰æ®µè·é›¢ï¼Œé è¿‘ç´…å²©å³½è°·ï¼Œæ°›åœéå¸¸æ”¾é¬†é«˜ç´šï¼Œæ²’æœ‰éŠå®¢çš„å–§å›‚ã€‚" },
                { name: "Wynn", tag: "èŠ±åœ’", desc: "èµ°é€²æ„›éº—çµ²å¤¢éŠä»™å¢ƒã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\nèµ°é€² Wynnå°±åƒèµ°é€²ä¸€å€‹å·¨å¤§çš„èŠ±åœ’ã€‚æ¯æ™šçš„ Lake of Dreams æ°´å¹•ç§€é›–ç„¶æ€ªæ€ªçš„ï¼ˆæœ‰å·¨å‹é’è›™å”±æ­Œï¼‰ï¼Œä½†å…è²»åˆç‰¹åˆ¥ã€‚" },
                { name: "Cosmopolitan", tag: "ç¶²ç¾", desc: "ä½åœ¨æ°´æ™¶ç‡ˆè£¡ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\nå¹´è¼•äººçš„æœ€æ„›ã€‚é‚£å€‹è²«ç©¿ä¸‰å±¤æ¨“çš„æ°´æ™¶åŠç‡ˆé…’å§ (Chandelier Bar) çµ•å°æ˜¯æ‹ç…§è–åœ°ã€‚è¨˜å¾—å»äºŒæ¨“åƒ Eggslutã€‚" },
                { name: "Caesars Palace", tag: "æµ®èª‡", desc: "é‡å›å¤ç¾…é¦¬ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\næƒ³é«”é©—é€™ç¨®æ¥µè‡´çš„å¥¢è¯æµ®èª‡ï¼Œå°±ä¾†é€™è£¡ã€‚Forum Shops è£¡çš„æ—‹è½‰æ‰‹æ‰¶æ¢¯å’Œæœƒå‹•çš„é›•åƒç§€æ˜¯ç¶“å…¸ã€‚" },
                { name: "Paris", tag: "æµªæ¼«", desc: "éµå¡”ä¸‹çš„æ™šé¤ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\néµå¡”è…³ç›´æ¥æ’é€²è³­å ´å±‹é ‚çš„è¨­è¨ˆå¤ªé…·äº†ã€‚æ¨è–¦å» Mon Ami Gabi åƒé£¯ï¼Œååœ¨æˆ¶å¤–å‰›å¥½å¯ä»¥çœ‹å°é¢çš„ Bellagio æ°´èˆã€‚" },
                { name: "Luxor", tag: "ç¥ç§˜", desc: "é€™å…‰æŸç›´å°„å®‡å®™ï¼", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦å»ï¼Ÿ**\né›–ç„¶é£¯åº—æœ‰é»èˆŠï¼Œä½†é‚£å€‹ç›´å°„å®‡å®™çš„è¶…ç´šå…‰æŸé‚„æ˜¯å¾ˆéœ‡æ’¼ã€‚è€Œä¸”ä½åœ¨é‡‘å­—å¡”è£¡ï¼Œé›»æ¢¯æ˜¯æ–œè‘—èµ°çš„å–”ï¼" }
            ]},
            { category: "ğŸ­ ç²¾å½©è¡¨æ¼”", content: [
                { name: "MJ One", tag: "å¿…çœ‹", desc: "è®“ MJ å¾©æ´»çš„ç¥å¥‡å¤§ç§€ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦çœ‹ï¼Ÿ**\nå°±ç®—ä½ ä¸æ˜¯ MJ éµç²‰ä¹Ÿæœƒè¢«éœ‡æ’¼ã€‚æœ€å¾Œçš„å…¨æ¯æŠ•å½±ï¼ˆHologramï¼‰è®“ä½ æ„Ÿè¦º MJ çœŸçš„å¾©æ´»äº†åœ¨å°ä¸Šè·³èˆï¼Œé‚£ç¬é–“å…¨å ´éƒ½æœƒèµ·é›çš®ç–™ç˜©ã€‚" },
                { name: "Magic Mike", tag: "å—¨ç¿»", desc: "é€™ä¸æ˜¯è„«è¡£èˆï¼Œæ˜¯æ´¾å°ï¼", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦çœ‹ï¼Ÿ**\né€™ä¸æ˜¯é‚£ç¨®ä½ä¿—çš„è„«è¡£èˆç§€ï¼Œè€Œæ˜¯ä¸€å ´ã€Œç‚ºäº†è®“å¥³æ€§é–‹å¿ƒã€è¨­è¨ˆçš„æ´¾å°ã€‚èˆè€…å¾ˆå¸¥ã€å¾ˆæœƒè·³ï¼Œè€Œä¸”éå¸¸å°Šé‡äººã€‚æ°£æ°›è¶…ç´šå—¨ï¼" },
                { name: "X Country", tag: "ç†±æƒ…", desc: "è¿‘è·é›¢çš„ç‰›ä»”ç†±èˆã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦çœ‹ï¼Ÿ**\nå¦‚æœä½ å–œæ­¡é„‰æ‘éŸ³æ¨‚çš„æ´»åŠ›ï¼Œé€™å ´ç§€å¾ˆé©åˆã€‚å ´åœ°å¾ˆå°ï¼Œäº’å‹•æ„Ÿå¾ˆå¼·ï¼Œèˆè€…éå¸¸æ•¬æ¥­å°ˆæ¥­ã€‚" },
                { name: "Fremont St", tag: "å…è²»", desc: "é ­é ‚ä¸Šçš„è¶…å¤§è¢å¹•ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦çœ‹ï¼Ÿ**\né€™æ˜¯è³­åŸçš„ç™¼æºåœ°ï¼Œæ°£æ°›æ¯” Strip æ›´ç‹‚é‡ä¸€é»ã€‚é ­é ‚ä¸Šæ˜¯ä¸–ç•Œæœ€å¤§çš„è¢å¹•ï¼Œæ¯å°æ™‚éƒ½æœ‰ç‡ˆå…‰ç§€ï¼Œè·¯é‚Šé‚„æœ‰å„ç¨®å¥‡æ€ªçš„è¡—é ­è—äººã€‚" },
                { name: "Bellagio Fountains", tag: "å…è²»", desc: "è³­åŸçš„éˆé­‚ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦çœ‹ï¼Ÿ**\né€™çµ•å°æ˜¯æ‹‰æ–¯ç¶­åŠ æ–¯çš„éˆé­‚ã€‚ä¸ç®¡çœ‹å¹¾æ¬¡ï¼Œé…åˆè‘— Andrea Bocelli çš„æ­Œè²ï¼Œæ°´æŸ±è¡ä¸Šå¤©éš›çš„æ™‚å€™é‚„æ˜¯æœƒå¾ˆæ„Ÿå‹•ã€‚" },
                { name: "Lake of Dreams", tag: "å…è²»", desc: "æœ‰é»æ€ªä½†å¾ˆé…·ã€‚", info: "ğŸ’¬ **ç‚ºä»€éº¼è¦çœ‹ï¼Ÿ**\né€™æ˜¯ä¸€å€‹å¾ˆå¥‡å¹»çš„å…è²»ç§€ã€‚å·¨å¤§çš„ç™½è‰²äººé ­å¾ç€‘å¸ƒå¾Œæ˜‡èµ·ä¾†ï¼Œé…ä¸Šç‡ˆå…‰æŠ•å½±ï¼Œæœ‰ä¸€ç¨®èªªä¸å‡ºçš„è¿·å¹»æ„Ÿã€‚" }
            ]}
        ];

        // --- PREP LIST DATA ---
        const prepItems = [
            "ğŸ“» å°è¬›æ©Ÿ (åœ‹å®¶å…¬åœ’ç„¡è¨Šè™Ÿ)",
            "ğŸ†” è­·ç…§ / ID / é§•ç…§",
            "ğŸ’³ ä¿¡ç”¨å¡ & ç¾é‡‘ (å°è²»)",
            "âœˆï¸ æ©Ÿç¥¨ & è¨‚æˆ¿ç¢ºèªå–®",
            "ğŸ§´ ä¿æ¿•ä¹³æ¶²/è­·å”‡è† (Vegasè¶…ä¹¾)",
            "ğŸ•¶ï¸ å¤ªé™½çœ¼é¡ & é˜²æ›¬",
            "ğŸ”Œ æ‰‹æ©Ÿå……é›»å™¨ & è¡Œå‹•é›»æº",
            "ğŸ§¥ ç¾½çµ¨è¡£/é˜²é¢¨å¤–å¥— (Zion/Bryce)",
            "ğŸ¥¾ å¥½èµ°çš„é‹/ç™»å±±é‹",
            "ğŸ§¢ æ¯›å¸½ & æ‰‹å¥— (Bryceæœƒå†·)",
            "ğŸ‘™ æ³³è¡£ (é£¯åº—æ³³æ± /Jacuzzi)",
            "ğŸ’Š å€‹äººè—¥å“/æšˆè»Šè—¥",
            "ğŸ—ºï¸ ä¸‹è¼‰é›¢ç·šåœ°åœ– (Utahå€åŸŸ)",
            "ğŸ« Show çš„é–€ç¥¨ (é›»å­æª”)",
            "ğŸ¦· ç‰™åˆ·ç‰™è† (æœ‰äº›é£¯åº—ä¸ä¸»å‹•çµ¦)"
        ];

        // --- LOGIC ---
        function renderDays() {
            const scroller = document.querySelector('.day-scroller');
            scroller.innerHTML = '';
            daysData.forEach((day, index) => {
                const chip = document.createElement('div');
                chip.className = `day-chip ${index === 0 ? 'active' : ''} animate-item`;
                chip.onclick = () => switchDay(index);
                chip.innerHTML = `<span class="d-date">${day.date}</span><span class="d-week">${day.week}</span>`;
                scroller.appendChild(chip);
            });
            switchDay(0);
            
            // Start Countdown
            updateCountdown();
            setInterval(updateCountdown, 60000);
            
            // Render Prep List
            renderPrepList();
        }

        function updateCountdown() {
            const tripStart = new Date('2025-11-25T00:00:00-08:00');
            const now = new Date();
            const diff = tripStart - now;
            const banner = document.getElementById('countdown-banner');
            if(diff > 0) {
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                banner.innerText = `è·é›¢å‡ºç™¼é‚„æœ‰ ${days}å¤© ${hours}å°æ™‚ âœˆï¸`;
                banner.style.opacity = '1'; 
            } else if (diff > -7 * 24 * 60 * 60 * 1000) {
                banner.innerText = "æ—…ç¨‹é€²è¡Œä¸­ ğŸ‰";
            } else {
                banner.style.display = 'none';
            }
        }

        function switchDay(index) {
            const data = daysData[index];
            document.getElementById('header-title').innerText = data.title;
            document.getElementById('header-subtitle').innerText = `${data.date} ${data.week}`;
            document.getElementById('header-subtitle').style.color = data.color;
            
            // Update global current location for weather click
            currentWeatherLoc = data.weatherLoc;
            
            document.querySelectorAll('.day-chip').forEach((chip, idx) => {
                if (idx === index) { chip.classList.add('active'); chip.style.backgroundColor = data.color; } 
                else { chip.classList.remove('active'); chip.style.backgroundColor = 'rgba(255,255,255,0.9)'; }
            });

            document.documentElement.style.setProperty('--theme-color', data.color);
            document.getElementById('bg-itinerary').style.backgroundImage = `url('${data.bgImg}')`;

            const container = document.getElementById('day-content');
            
            // Scroll to top of itinerary content
            const itContent = document.getElementById('tab-itinerary');
            if(itContent) itContent.scrollTop = 0;

            let weatherGradient = `linear-gradient(135deg, ${data.color}dd 0%, ${data.color} 100%)`;
            if(data.color === "#27AE60") weatherGradient = "linear-gradient(135deg, #43cea2 0%, #185a9d 100%)";
            if(data.color === "#8E44AD") weatherGradient = "linear-gradient(135deg, #cc2b5e 0%, #753a88 100%)";
            
            let html = `
                <a href="${data.mapUrl}" target="_blank" class="map-btn-compact animate-item">
                    <i data-lucide="map-pin"></i> æŸ¥çœ‹ä»Šæ—¥è·¯ç·šåœ°åœ–
                </a>
                
                <div id="day-weather-card" class="weather-detail-card animate-item" style="background: ${weatherGradient}" onclick="window.open('https://www.google.com/search?q=weather+${data.weatherLoc}','_blank')">
                    <div class="wd-header">
                        <span class="wd-title"><i data-lucide="cloud-sun"></i> æ—©ä¸Š9é» - æ™šä¸Š9é»</span>
                        <span class="wd-info" id="w-header-info">æœ€é«˜: --Â° | æœ€ä½: --Â°</span>
                    </div>
                    <div class="wd-chart-container">
                        <!-- Overlay for Icons -->
                        <div id="chart-icons-layer"></div>
                        <!-- SVG Chart -->
                        <svg class="wd-chart-svg" id="w-chart" viewBox="0 0 300 150">
                            <!-- Line and dots will be injected here -->
                        </svg>
                    </div>
                </div>
            `;

            if (data.shuttle) {
                html += `
                <div class="card shuttle-block animate-item" style="border-left: 5px solid ${data.color}">
                    <div class="shuttle-title" style="color:${data.color}"><i data-lucide="bus"></i> éŒ«å®‰æ¥é§è»Š</div>
                    <div class="shuttle-container"><h3 style="margin:0 0 5px; color:#27AE60; font-size:14px;">ğŸŸ¢ ç¶ ç·š (å…¬åœ’å…§)</h3><p style="font-size:12px; color:#666; margin:0;">éŠå®¢ä¸­å¿ƒ â‡„ Temple of Sinawava</p></div>
                    <div class="shuttle-container"><h3 style="margin:0 0 5px; color:#E67E22; font-size:14px;">ğŸŸ  æ©˜ç·š (å¸‚å€)</h3><p style="font-size:12px; color:#666; margin:0;">Springdale â‡„ å…¬åœ’å…¥å£</p></div>
                </div>`;
            }

            html += `<div class="card animate-item">`; 
            data.content.forEach((item) => {
                const safeName = item.name.replace(/'/g, "\\'").replace(/"/g, "&quot;"); 
                const safeDesc = item.desc.replace(/'/g, "\\'").replace(/"/g, "&quot;"); 
                const safeInfo = item.info.replace(/'/g, "\\'").replace(/"/g, "&quot;").replace(/\n/g, "\\n");
                html += `
                    <div class="place-item" onclick="openModal('${safeName}', '${safeDesc}', '${safeInfo}')">
                        <div class="place-header"><span class="place-name" style="color:${data.color}">${item.name}</span><span class="place-tag">${item.tag}</span></div>
                        <p class="place-desc">${item.desc}</p>
                    </div>`;
            });
            html += `</div>`;
            container.innerHTML = html;
            lucide.createIcons();
            fetchDetailedWeather(data.coords, data.fullDate);
            fetchCurrentWeather(data.coords, data.weatherLoc);
        }

        // Function to open weather from header
        function openCurrentWeather() {
            if(currentWeatherLoc) {
                window.open(`https://www.google.com/search?q=weather+${currentWeatherLoc}`, '_blank');
            }
        }

        function renderGuideScroller() {
            const scroller = document.getElementById('guide-scroller');
            scroller.innerHTML = '';
            guideData.forEach((cat, index) => {
                const chip = document.createElement('div');
                chip.className = `guide-chip ${index === 0 ? 'active' : ''} animate-item`;
                chip.innerText = cat.category;
                chip.onclick = () => switchGuideCategory(index);
                scroller.appendChild(chip);
            });
            switchGuideCategory(0);
        }

        function switchGuideCategory(index) {
            const data = guideData[index];
            const chips = document.querySelectorAll('.guide-chip');
            chips.forEach((chip, idx) => {
                if (idx === index) chip.classList.add('active');
                else chip.classList.remove('active');
            });

            const container = document.getElementById('guide-content');
            
            // Handle "Prep" special case
            if (data.id === 'prep') {
                let html = `
                    <!-- Tips Card -->
                    <div class="card animate-item" style="margin-top:10px;">
                        <div class="place-item" onclick="openModal('è¡Œå‰é‡è¦æé†’', 'åˆ¥å¿˜äº†é€™äº›ï¼', '1. ä¸‹è¼‰é›¢ç·šåœ°åœ–ï¼š\\nåœ‹å®¶å…¬åœ’å…§(Zion, Bryce)å¤§éƒ¨åˆ†åœ°å€å®Œå…¨æ²’æœ‰è¨Šè™Ÿã€‚å‡ºç™¼å‰è«‹åœ¨ Google Maps ä¸‹è¼‰ã€ŒUtahã€å€åŸŸçš„é›¢ç·šåœ°åœ–ã€‚\\n\\n2. æ™‚å€è®Šæ›ï¼š\\nUtah (çŒ¶ä»–å·) ä½¿ç”¨ MST æ™‚é–“ï¼Œæ¯” Las Vegas/åŠ å· (PST) å¿«ä¸€å°æ™‚ï¼æ‰‹æ©Ÿæœƒè‡ªå‹•è·³è½‰ï¼Œä½†è«‹ç•™æ„æ‰‹éŒ¶æ™‚é–“ï¼Œé¿å…éŒ¯éé ç´„ã€‚\\n\\n3. ç©¿è‘—å»ºè­°ï¼š\\nBryce Canyon æµ·æ‹”å¾ˆé«˜ï¼Œéå¸¸å†·ï¼ˆå¯èƒ½ä¸‹é›ªï¼‰ï¼Œè«‹å¸¶ç¾½çµ¨è¡£ã€æ¯›å¸½ã€æ‰‹å¥—ã€‚Vegas æ™šä¸Šé¢¨å¤§ä¹Ÿåæ¶¼ã€‚')">
                            <div class="place-header"><span class="place-name">ğŸ’¡ é‡è¦æé†’</span></div>
                            <p class="place-desc">é›¢ç·šåœ°åœ–ã€æ™‚å€è®Šæ›ã€æ´‹è”¥å¼ç©¿æ­ã€‚</p>
                        </div>
                    </div>

                    <!-- Packing List Container -->
                    <div class="card animate-item">
                        <div class="packing-header">
                            <div class="place-header"><span class="place-name">ğŸ’ æ‰“åŒ…æ¸…å–®</span><span class="place-tag highlight" id="pack-count">0/0</span></div>
                            <div class="progress-container"><div class="progress-bar" id="pack-progress"></div></div>
                            <div class="progress-text"><span>å®Œæˆåº¦</span><span id="pack-percent">0%</span></div>
                        </div>
                        <div id="packing-list"></div>
                    </div>
                    <button class="btn-action animate-item" style="width:100%; justify-content:center; margin-top:20px; background:rgba(255,255,255,0.5);" onclick="resetPackingList(this)">é‡ç½®æ¸…å–®</button>
                `;
                container.innerHTML = html;
                renderPrepList(); // Populate checklist
                return;
            }

            // Normal Guide Card Rendering
            let html = `<div class="card animate-item" style="margin-top:10px;">`;
            data.content.forEach(item => {
                const safeName = item.name.replace(/'/g, "\\'").replace(/"/g, "&quot;"); 
                const safeDesc = item.desc.replace(/'/g, "\\'").replace(/"/g, "&quot;"); 
                const safeInfo = item.info.replace(/'/g, "\\'").replace(/"/g, "&quot;").replace(/\n/g, "\\n");
                html += `
                    <div class="place-item" onclick="openModal('${safeName}', '${safeDesc}', '${safeInfo}')">
                        <div class="place-header"><span class="place-name">${item.name}</span><span class="place-tag secondary">${item.tag}</span></div>
                        <p class="place-desc">${item.desc}</p>
                    </div>`;
            });
            html += `</div>`;
            container.innerHTML = html;
        }

        // --- PREP LIST LOGIC ---
        function renderPrepList() {
            const container = document.getElementById('packing-list');
            if(!container) return;
            container.innerHTML = '';
            
            const savedState = JSON.parse(localStorage.getItem('tripPrepState') || '{}');
            let checkedCount = 0;

            prepItems.forEach((item, index) => {
                const isChecked = savedState[index] || false;
                if(isChecked) checkedCount++;
                
                const div = document.createElement('div');
                div.className = `checkbox-item ${isChecked ? 'checked' : ''}`;
                div.onclick = () => toggleCheck(index);
                div.innerHTML = `
                    <div class="custom-checkbox"><i data-lucide="check" class="check-icon" size="16"></i></div>
                    <span class="place-name" style="font-size:15px; font-weight:500;">${item}</span>
                `;
                container.appendChild(div);
            });
            
            updateProgress(checkedCount, prepItems.length);
            lucide.createIcons();
        }

        function toggleCheck(index) {
            const savedState = JSON.parse(localStorage.getItem('tripPrepState') || '{}');
            savedState[index] = !savedState[index];
            localStorage.setItem('tripPrepState', JSON.stringify(savedState));
            renderPrepList();
        }

        function updateProgress(checked, total) {
            const percent = Math.round((checked / total) * 100);
            const bar = document.getElementById('pack-progress');
            const pText = document.getElementById('pack-percent');
            const count = document.getElementById('pack-count');
            
            if(bar) bar.style.width = `${percent}%`;
            if(pText) pText.innerText = `${percent}%`;
            if(count) count.innerText = `${checked}/${total}`;
        }

        function resetPackingList(btnElement) {
            if (btnElement.innerText === "é‡ç½®æ¸…å–®") {
                btnElement.innerText = "ç¢ºå®šè¦é‡ç½®ï¼Ÿ(é»æ“Šç¢ºèª)";
                btnElement.style.backgroundColor = "#ffeba1"; 
                btnElement.style.color = "#d35400";
                
                setTimeout(() => {
                    if (btnElement.innerText !== "é‡ç½®æ¸…å–®" && btnElement.innerText !== "å·²å®Œæˆé‡ç½®") {
                       btnElement.innerText = "é‡ç½®æ¸…å–®";
                       btnElement.style.backgroundColor = "rgba(255,255,255,0.5)";
                       btnElement.style.color = "var(--theme-color)";
                    }
                }, 3000);
                return;
            }

            localStorage.removeItem('tripPrepState');
            renderPrepList();
            
            btnElement.innerText = "å·²å®Œæˆé‡ç½®";
            btnElement.style.backgroundColor = "#d4edda";
            btnElement.style.color = "#155724";
            
            setTimeout(() => {
                btnElement.innerText = "é‡ç½®æ¸…å–®";
                btnElement.style.backgroundColor = "rgba(255,255,255,0.5)";
                btnElement.style.color = "var(--theme-color)";
            }, 1500);
        }

        function switchTab(tabId, el) {
            document.querySelectorAll('.content-area').forEach(div => div.classList.remove('active'));
            document.querySelectorAll('.tab-item').forEach(item => item.classList.remove('active'));
            document.querySelectorAll('.bg-image').forEach(bg => bg.classList.remove('active'));

            // Handle Weather Widget Visibility
            const weatherWidget = document.querySelector('.weather-widget');
            if (tabId === 'itinerary') {
                if(weatherWidget) {
                    weatherWidget.style.visibility = 'visible';
                    weatherWidget.style.opacity = '1';
                }
            } else {
                if(weatherWidget) {
                    weatherWidget.style.opacity = '0';
                    setTimeout(() => weatherWidget.style.visibility = 'hidden', 300);
                }
            }

            // Handle Themes
            if (tabId === 'itinerary') {
                document.getElementById('bg-itinerary').classList.add('active');
                const activeIndex = Array.from(document.querySelectorAll('.day-chip')).findIndex(c => c.classList.contains('active'));
                switchDay(activeIndex !== -1 ? activeIndex : 0);
            } else if (tabId === 'flights') {
                document.getElementById('bg-flights').classList.add('active');
                document.documentElement.style.setProperty('--theme-color', '#2980b9'); 
                document.getElementById('header-title').innerText = "äº¤é€šè³‡è¨Š";
                document.getElementById('header-subtitle').innerText = "Flights & Car";
                document.getElementById('header-subtitle').style.color = '#2980b9';
            } else if (tabId === 'hotels') {
                document.getElementById('bg-hotels').classList.add('active');
                document.documentElement.style.setProperty('--theme-color', '#8e44ad'); 
                document.getElementById('header-title').innerText = "ä½å®¿å®‰æ’";
                document.getElementById('header-subtitle').innerText = "Hotels";
                document.getElementById('header-subtitle').style.color = '#8e44ad';
            } else if (tabId === 'guide') {
                document.getElementById('bg-guide').classList.add('active');
                document.documentElement.style.setProperty('--theme-color', '#27ae60'); 
                document.getElementById('header-title').innerText = "æ—…éŠæŒ‡å—";
                document.getElementById('header-subtitle').innerText = "Explore";
                document.getElementById('header-subtitle').style.color = '#27ae60';
                if(document.getElementById('guide-content').innerHTML === "") renderGuideScroller();
                if(document.getElementById('guide-scroller').children.length === 0) renderGuideScroller();
            }

            document.getElementById('tab-' + tabId).classList.add('active');
            el.classList.add('active');
        }

        function openModal(title, subtitle, desc) {
            document.getElementById('modal-title').innerText = title;
            document.getElementById('modal-desc').innerHTML = `<strong>${subtitle}</strong><br><br>${desc.replace(/\n/g, '<br>')}`;
            document.getElementById('detail-modal').classList.add('open');
        }
        function closeModal() { document.getElementById('detail-modal').classList.remove('open'); }

        async function fetchCurrentWeather(coords, locName) {
            const [lat, long] = coords.split(',');
            document.getElementById('current-loc').innerText = locName;
            try {
                const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${long}&current=temperature_2m&temperature_unit=celsius`;
                const res = await fetch(url); const json = await res.json();
                document.getElementById('current-temp').innerText = `${Math.round(json.current.temperature_2m)}Â°C`;
            } catch (e) { console.error(e); }
        }
        
        // --- Helper: Map Weather Code to Lucide Icon Name ---
        function getIconFromCode(code) {
            if (code === 0) return 'sun';
            if (code <= 3) return 'cloud-sun';
            if (code <= 48) return 'cloud-fog';
            if (code <= 67) return 'cloud-rain';
            if (code <= 77) return 'snowflake';
            if (code <= 82) return 'cloud-rain';
            if (code <= 86) return 'snowflake';
            return 'cloud-lightning'; // 95+
        }

        // 2. Detailed Weather Card (Chart + Sunset + ICONS)
        async function fetchDetailedWeather(coords, dateStr) {
            const [lat, long] = coords.split(',');
            try {
                // Add weathercode to fetching
                const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${long}&daily=temperature_2m_max,temperature_2m_min,sunset&hourly=temperature_2m,weathercode&start_date=${dateStr}&end_date=${dateStr}&temperature_unit=celsius&timezone=auto`;
                const res = await fetch(url); 
                const json = await res.json();

                if(json.daily && json.daily.temperature_2m_max) {
                    const max = Math.round(json.daily.temperature_2m_max[0]);
                    const min = Math.round(json.daily.temperature_2m_min[0]);
                    let sunsetTime = "--:--";
                    if(json.daily.sunset && json.daily.sunset[0]) {
                        const dateObj = new Date(json.daily.sunset[0]);
                        let hours = dateObj.getHours();
                        const minutes = dateObj.getMinutes().toString().padStart(2, '0');
                        const ampm = hours >= 12 ? 'ä¸‹åˆ' : 'ä¸Šåˆ';
                        hours = hours % 12;
                        hours = hours ? hours : 12; 
                        sunsetTime = `${ampm} ${hours}:${minutes}`;
                    }
                    const hlElement = document.getElementById('w-header-info');
                    if(hlElement) hlElement.innerText = `æœ€é«˜:${max}Â° æœ€ä½:${min}Â° | æ—¥è½ ${sunsetTime}`;
                }

                if(json.hourly && json.hourly.temperature_2m) {
                    const hoursTemp = json.hourly.temperature_2m.slice(9, 22); // 9am to 9pm inclusive
                    const hoursCode = json.hourly.weathercode.slice(9, 22);
                    currentHourlyTemps = hoursTemp;
                    currentHourlyCodes = hoursCode; // Store codes
                    drawChart(hoursTemp, hoursCode);
                }
            } catch (e) { 
                console.error("Weather error", e); 
                const card = document.getElementById('day-weather-card');
                if(card) card.style.display = 'none'; 
            }
        }

        function drawChart(temps, codes) {
            if (!temps) temps = currentHourlyTemps;
            if (!codes) codes = currentHourlyCodes;
            
            if (!temps || temps.length === 0) return;

            const container = document.querySelector('.wd-chart-container');
            const svg = document.getElementById('w-chart');
            const iconsLayer = document.getElementById('chart-icons-layer');
            
            const w = container.getBoundingClientRect().width || 300;
            const h = 160; // Match CSS height

            // Clear previous content
            svg.innerHTML = '';
            iconsLayer.innerHTML = ''; // Clear icons
            
            svg.removeAttribute('preserveAspectRatio');
            svg.setAttribute('viewBox', `0 0 ${w} ${h}`);

            const padding = 15; 
            const minTemp = Math.min(...temps) - 1;
            const maxTemp = Math.max(...temps) + 1;
            const range = maxTemp - minTemp;

            let points = "";
            let circles = "";
            let labels = "";
            let timeLabels = "";
            // Shift chart down to make room for icons at top
            // Height usage: 
            // 0-30px: Icons area
            // 30-130px: Graph area (100px height)
            // 130-150px: Time labels
            
            const chartTop = 30;
            const chartBottom = h - 20; 
            const graphHeight = chartBottom - chartTop - 20; // buffer for temp text

            let areaPath = `M ${padding},${chartBottom} `;
            const stepX = (w - padding * 2) / (temps.length - 1);

            temps.forEach((t, i) => {
                const x = padding + i * stepX;
                const y = chartBottom - ((t - minTemp) / range) * graphHeight;
                
                points += `${x},${y} `;
                areaPath += `L ${x},${y} `;

                // Graph Dots & Temp Text
                circles += `<circle cx="${x}" cy="${y}" r="3" class="chart-dot" />`;
                labels += `<text x="${x}" y="${y - 10}" class="chart-text">${Math.round(t)}Â°</text>`;
                
                // Time Label Logic
                let timeVal = (9 + i);
                let displayTime;
                if (timeVal === 12) {
                    displayTime = "ä¸­åˆ";
                } else {
                    displayTime = timeVal;
                    if (timeVal > 12) displayTime -= 12;
                    displayTime += "æ™‚";
                }
                timeLabels += `<text x="${x}" y="${h - 5}" class="chart-label">${displayTime}</text>`;

                // Icon Injection (HTML overlay)
                // Position absolute div at x
                // We use percentages if we want it perfectly robust on resize, or pixel based on 'x'
                // Since we redraw on resize, pixel 'x' is fine.
                if(codes && codes[i] !== undefined) {
                    const iconName = getIconFromCode(codes[i]);
                    const iconDiv = document.createElement('div');
                    iconDiv.className = 'chart-icon-wrapper';
                    iconDiv.style.left = `${x}px`;
                    iconDiv.style.top = '5px'; // Fixed at top of container
                    // Insert Lucide icon element
                    iconDiv.innerHTML = `<i data-lucide="${iconName}"></i>`;
                    iconsLayer.appendChild(iconDiv);
                }
            });
            
            const lastX = padding + (temps.length - 1) * stepX;
            areaPath += `L ${lastX},${chartBottom} Z`;

            svg.innerHTML = `<path d="${areaPath}" class="chart-area" /><polyline points="${points}" class="chart-line" />${circles}${labels}${timeLabels}`;
            
            // IMPORTANT: Trigger Lucide to render the new icons we just added to DOM
            lucide.createIcons();
        }

        window.addEventListener('resize', () => { drawChart(); });
        window.onload = renderDays;
    </script>
</body>
</html>
